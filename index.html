
<!DOCTYPE html>
<html>
<head>
	<title> 166 Inter
	</title>
<head>
<body>


<img  src="https://raw.githubusercontent.com/166inter/166inter.github.io/master/Ferrari_166-Inter_STRADA_xMAM1651_491040.jpg" alt="166 Inter" style="width:330px;height:355px;" border = "1px" alt="Ferrari_166-Inter_STRADA_xMAM1651_491040.jpg"  />

<h1> 166 Inter: Open Source and Self-Learning for the Open Road
</h1>
<p align="left">	&emsp; The 166 Inter is considered to be Ferrari's first grand touring car. The concept of grand touring is synonomous with freedom. The open road, the indefinite journey and endless ground to discover are ideas that underly both this car and my philosophy. On this page, I will post -- from the viewpoint of a beginner -- about some current open source technology and some of the exciting ground there is to discover. I will also share parts of my journey. Have fun! </p>
<p> <sub> image source: auto.ferrari.com </sub></p>




<ul>
<hr/>
<h2>
<p> July 22 2017: Re-training Tensorflow's Inception to classify car origin</p>
</h2>

<h3> Introduction: </h4>

<p> &emsp; I was walking home the other day this week, looking at the various cars on the street German, Japanese, American and so on and it got me thinking. What is it that I find more visually appealing about German and Japanese cars? Why do I react differently to cars from certain countries? Is there something fundamental about British styling, Italian styling, and so on? Google not too long ago open-sourced a pre-trained, 40+ layer deep neural network called Inception. Alongside, there is a tutorial, <a href="https://codelabs.developers.google.com/codelabs/tensorflow-for-poets/#0" target="_blank"> Tensorflow for Poets <a>, which shows how to use this network and train the last layer so you can have it classify between your very own image datasets! </p>

<h3> Methods: </h4>
<p> &emsp; I followed the tutorial and then tried it again with a data set of about 500 images, about a fifth from each of five car origins: Germany, Japan, United States, Italy and Great Britain. There are some Google Chrome extensions you can use to bulk download Google Images results. I had to clean up what I downloaded and delete some photos that were out of place. The photos are about 10-20 kb in size, which makes them faster to train with. </p>
<h3> Results: </h4>
<p> &emsp; While training with flower data set given in the tutorial yieled around 90% test accuracy, the network achieved just 73.1% on my much smaller dataset of car photos. Keep in mind, if one were to make random guesses, they would most likely average 20% accuracy. Below are some additional test results for some novel downloaded images, 2 from each car origin. The network does  make some funny predictions, but other predictions are very good: </p>
<pre>
  <code>
2017-07-22 04:57:55.607929: Step 490: Train accuracy = 76.0%
2017-07-22 04:57:55.608473: Step 490: Cross entropy = 0.764508
2017-07-22 04:57:55.916217: Step 490: Validation accuracy = 58.0% (N=100)
2017-07-22 04:57:58.682838: Step 499: Train accuracy = 74.0%
2017-07-22 04:57:58.683158: Step 499: Cross entropy = 0.778337
2017-07-22 04:57:58.989198: Step 499: Validation accuracy = 60.0% (N=100)
Final test accuracy = 73.1% (N=52)
  </code>
</pre>
<table width="50%" cellspacing="0">
	<tr>
		<td><img  src="test_photos/german_test.jpg" alt="Image not found" style="width:180px" border = "1px" />
		

		</td>
		<td width="500%" align="center"><pre>
							<code>
label_image.py german_test.jpg
italian (score = 0.25074)
german (score = 0.22876)
japanese (score = 0.21431)
american (score = 0.15670)
british (score = 0.14949)
</code>
</pre>
		</td>
	</tr>

<tr>
		<td><img  src="test_photos/japanese_test.jpg" alt="Image not found" style="width:110%" border = "1px" />
		</td>
		<td width="500%" align="center"> <pre>
							<code>
label_image.py japanese_test.jpg
american (score = 0.27312)
german (score = 0.25250)
british (score = 0.21902)
italian (score = 0.18549)
japanese (score = 0.06987)
</code>
</pre>
		</td>
	</tr>

<tr>
		<td><img  src="test_photos/british_test.jpg" alt="Image not found" style="width:110%" border = "1px" />


		</td>
		<td width="50%" align="center"><pre>
							<code>
python label_image.py british_test.jpg
british (score = 0.53528)
american (score = 0.20071)
german (score = 0.15943)
italian (score = 0.08448)
japanese (score = 0.02009)
</code>
</pre>
		</td>
	</tr>

<tr>
		<td><img  src="test_photos/italian_test.jpg" alt="Image not found" style="width:110%" border = "1px" />


		</td>
		<td width="50%" align="center"><pre>
							<code>
python label_image.py italian_test.jpg
italian (score = 0.58346)
german (score = 0.19087)
american (score = 0.08351)
japanese (score = 0.07983)
british (score = 0.06233)
</code>
</pre>
		</td>
	</tr>

<tr>
		<td><img  src="test_photos/american_test.jpg" alt="Image not found" style="width:110%" border = "1px" />


		</td>
		<td width="50%" align="center"><pre>
							<code>
python label_image.py american_test.jpg
german (score = 0.47028)
british (score = 0.25817)
american (score = 0.23781)
italian (score = 0.02941)
japanese (score = 0.00434)
</code>
</pre>
		</td>
	</tr>
	<tr>
		<td><img  src="test_photos/german_test_2.jpg" alt="Image not found" style="width:180px" border = "1px" />
		

		</td>
		<td width="500%" align="center"><pre>
							<code>
label_image.py german_test_2.jpg
german (score = 0.45688)
british (score = 0.23318)
italian (score = 0.15506)
american (score = 0.12687)
japanese (score = 0.02800)
</code>
</pre>
		</td>
	</tr>

<tr>
		<td><img  src="test_photos/japanese_test_2.jpg" alt="Image not found" style="width:110%" border = "1px" />
		</td>
		<td width="500%" align="center"> <pre>
							<code>
label_image.py japanese_test_2.jpg
japanese (score = 0.91580)
german (score = 0.03405)
american (score = 0.01899)
italian (score = 0.01780)
british (score = 0.01336)
</code>
</pre>
		</td>
	</tr>

<tr>
		<td><img  src="test_photos/british_test_2.jpg" alt="Image not found" style="width:110%" border = "1px" />


		</td>
		<td width="50%" align="center"><pre>
							<code>
python label_image.py british_test_2.jpg
german (score = 0.46645)
british (score = 0.23532)
italian (score = 0.12662)
american (score = 0.08663)
japanese (score = 0.08498)
</code>
</pre>
		</td>
	</tr>

<tr>
		<td><img  src="test_photos/italian_test_2.jpg" alt="Image not found" style="width:110%" border = "1px" />


		</td>
		<td width="50%" align="center"><pre>
							<code>
python label_image.py italian_test_2.jpg
italian (score = 0.58812)
british (score = 0.13577)
japanese (score = 0.12287)
german (score = 0.12016)
american (score = 0.03308)
</code>
</pre>
		</td>
	</tr>

<tr>
		<td><img  src="test_photos/american_test_2.jpg" alt="Image not found" style="width:110%" border = "1px" />


		</td>
		<td width="50%" align="center"><pre>
							<code>
python label_image.py american_test_2.jpg
german (score = 0.48871)
british (score = 0.36794)
american (score = 0.08926)
italian (score = 0.02975)
japanese (score = 0.02435)
</code>
</pre>
		</td>
	</tr>

</table>

<h3> Discussion: </h4>
<p> &emsp; This neural network is not going to outsmart a car fanatic quite yet. However, for a network trained on around 500 images, and all hyperparameters left untouched, it is quite impressive that it can guess better than 3x what random guessing would result in. Having cars from a very large time span added to the network's difficulty in making predictions. Design languages are not mutually exclusive from origin to origin so it can be difficult even for a car fanatic to make some distinctions. For example, the Kia Motors aquired a German designer to design the Kia Optima a few years back and it naturally had some German design cues.   </p>

<h3> Conclusion: </h4>
<p> &emsp; There is certainly a correlation between the country of origin of various car and their respective design cues. The network could not simply read the badges for the various cars, so it had to recognize actual design features. The network did not do a very good job, but there is plenty of room for improvement. </p>
<h3> Future work: </h4>
<p> &emsp; Since neural networks always work better with more data, adding more training examples would certainly yield better results. The hyperparameters could be tweaked. We could see how a simpler convolutional neural network with fewer layers would fare (this would require going beyond simply retraining Inception and creating our own network). The dataset could also be refined and cleaned to include only cars from a specified era to see if this would give better results.</p>
<hr/>
<h2>
<p> Some useful tools and learning resources: </p>
</h2>

<ul>
<li> <a href="https://www.tensorflow.org/" target="_blank" > Tensorflow </a> </li>
<li><a href="https://www.coursera.org/" target="_blank" > Coursera </a> </li>
<li><a href="https://www.udacity.com/" target="_blank" > Udacity </a> </li>

</ul>

</body>
</html>